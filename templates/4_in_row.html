<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect Four with PyScript</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pyscript@0.11.0/dist/pyscript.css">
    <style>
        .board { display: grid; grid-template-columns: repeat(7, 100px); grid-gap: 5px; }
        .board div { width: 100px; height: 100px; border-radius: 50%; border: 2px solid black; }
        #scoreboard { font-size: 18px; margin-bottom: 10px; }
        #message { font-size: 24px; margin-top: 10px; }
    </style>
</head>
<body>
    <div id="scoreboard">Player 1: 0   Player 2: 0</div>
    <div id="message">Player 1's turn</div>
    <div class="board" id="board"></div>
    <button id="reset">Reset Game</button>
    
    <script src="https://cdn.jsdelivr.net/npm/pyscript@0.11.0/dist/pyscript.js"></script>
    <py-script>
from pyscript import Element
import numpy as np
import math

# Constants
ROW_COUNT = 6
COL_COUNT = 7
EMPTY = 0
PLAYER1 = 1
PLAYER2 = 2

# Colors
blue = (0, 32, 255)
white = (234, 234, 234)
red = (255, 0, 0)
yellow = (255, 254, 0)

# Initialize the board
def create_board():
    return np.zeros((ROW_COUNT, COL_COUNT), int)

def drop_piece(board, row, col, piece):
    board[row][col] = piece

def valid_location(board, col):
    return board[ROW_COUNT-1][col] == EMPTY

def next_open_row(board, col):
    for r in range(ROW_COUNT):
        if board[r][col] == EMPTY:
            return r
    return -1

def winning_move(board, piece):
    # Check horizontal locations
    for c in range(COL_COUNT-3):
        for r in range(ROW_COUNT):
            if board[r][c] == piece and board[r][c+1] == piece and board[r][c+2] == piece and board[r][c+3] == piece:
                return True

    # Check vertical locations
    for c in range(COL_COUNT):
        for r in range(ROW_COUNT-3):
            if board[r][c] == piece and board[r+1][c] == piece and board[r+2][c] == piece and board[r+3][c] == piece:
                return True

    # Check positively sloped diagonals
    for c in range(COL_COUNT-3):
        for r in range(ROW_COUNT-3):
            if board[r][c] == piece and board[r+1][c+1] == piece and board[r+2][c+2] == piece and board[r+3][c+3] == piece:
                return True

    # Check negatively sloped diagonals
    for c in range(COL_COUNT-3):
        for r in range(3, ROW_COUNT):
            if board[r][c] == piece and board[r-1][c+1] == piece and board[r-2][c+2] == piece and board[r-3][c+3] == piece:
                return True
    return False

def draw_board(board):
    board_element = Element('board').element
    board_element.innerHTML = ''
    for r in range(ROW_COUNT):
        for c in range(COL_COUNT):
            div = document.createElement('div')
            if board[r][c] == PLAYER1:
                div.style.backgroundColor = 'red'
            elif board[r][c] == PLAYER2:
                div.style.backgroundColor = 'yellow'
            board_element.appendChild(div)

def reset_board():
    global board, turn, game_over
    board = create_board()
    turn = PLAYER1
    game_over = False
    draw_board(board)
    Element('message').element.textContent = "Player 1's turn"

def on_click(event):
    global turn, game_over
    if game_over:
        return
    col = event.target.cellIndex
    if valid_location(board, col):
        row = next_open_row(board, col)
        drop_piece(board, row, col, turn)
        if winning_move(board, turn):
            Element('message').element.textContent = f"Player {'1' if turn == PLAYER1 else '2'} wins!!"
            game_over = True
        else:
            turn = PLAYER2 if turn == PLAYER1 else PLAYER1
            Element('message').element.textContent = f"Player {'1' if turn == PLAYER1 else '2'}'s turn"
        draw_board(board)

# Initialize
board = create_board()
turn = PLAYER1
game_over = False
draw_board(board)

# Event listeners
Element('board').element.onclick = on_click
Element('reset').element.onclick = reset_board
    </py-script>
</body>
</html>
